<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>TestPostgres — API Test UI</title>
        <style>
            :root{
                --bg:#0f1720; --panel:#0b1220; --muted:#9aa4b2; --accent:#7c3aed; --glass: rgba(255,255,255,0.03);
            }
            html,body{height:100%;}
            body{
                margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
                background:linear-gradient(180deg,var(--bg),#071018); color:#e6eef8;
                -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
            }
            .app{max-width:1100px;margin:28px auto;padding:20px;}
            header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
            .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#4f46e5);display:flex;align-items:center;justify-content:center;font-weight:700}
            h1{font-size:20px;margin:0}
            p.lead{margin:0;color:var(--muted);font-size:13px}

            .grid{display:grid;grid-template-columns:1fr 420px;gap:18px}

            .panel{background:var(--panel);border-radius:12px;padding:16px;box-shadow:0 6px 30px rgba(2,6,23,0.6);}
            .panel h2{margin:0 0 12px 0;font-size:14px}
            .controls{display:flex;gap:8px;flex-wrap:wrap}
            input[type=text], input[type=number], input[type=date], input[type=datetime-local], select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit}
            label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
            .row{display:flex;gap:8px}
            .btn{background:var(--accent);color:white;padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
            .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
            .muted{color:var(--muted);font-size:13px}
            .list{max-height:420px;overflow:auto;margin-top:8px;border-radius:8px;padding:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
            table{width:100%;border-collapse:collapse;font-size:13px}
            th,td{padding:8px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.03)}
            pre{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;color:var(--muted);overflow:auto}
            .small{font-size:12px}
            footer{margin-top:16px;text-align:right;color:var(--muted);font-size:12px}
        </style>
    </head>
    <body>
        <div class="app">
            <header>
                <div class="logo">DB</div>
                <div>
                    <h1>TestPostgres API — dvdrental</h1>
                    <p class="lead">Quick test UI for `TestPostgresController` (customers). Dark, minimal, and functional.</p>
                </div>
            </header>

            <div class="grid">
                <section class="panel">
                    <h2>Customers — Quick Actions</h2>

                    <div style="display:flex;gap:8px;align-items:end;margin-bottom:8px">
                        <div style="flex:1">
                            <label>Limit</label>
                            <input id="limit" type="number" value="10" min="1" />
                        </div>
                        <div style="width:120px">
                            <label>&nbsp;</label>
                            <button class="btn" id="btn-list">List latest</button>
                        </div>
                    </div>

                    <div style="display:flex;gap:8px;margin-bottom:12px">
                        <div style="flex:1">
                            <label>Get by ID</label>
                            <input id="get-id" type="number" placeholder="customer id" />
                        </div>
                        <div style="width:120px">
                            <label>&nbsp;</label>
                            <button class="btn ghost" id="btn-get">Get</button>
                        </div>
                    </div>

                    <div style="display:flex;gap:8px;margin-bottom:12px">
                        <div style="flex:1">
                            <label>Delete by ID</label>
                            <input id="del-id" type="number" placeholder="customer id" />
                        </div>
                        <div style="width:120px">
                            <label>&nbsp;</label>
                            <button class="btn ghost" id="btn-delete">Delete</button>
                        </div>
                    </div>

                    <h2 style="margin-top:12px">Create / Update Customer</h2>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
                        <div>
                            <label>Store Id</label>
                            <input id="c-storeId" type="number" value="1" />
                        </div>
                        <div>
                            <label>Address Id</label>
                            <input id="c-addressId" type="number" value="1" />
                        </div>
                        <div>
                            <label>First Name</label>
                            <input id="c-firstName" type="text" />
                        </div>
                        <div>
                            <label>Last Name</label>
                            <input id="c-lastName" type="text" />
                        </div>
                        <div>
                            <label>Email</label>
                            <input id="c-email" type="text" />
                        </div>
                        <div>
                            <label>Active Bool</label>
                            <select id="c-activeBool"><option value="true">true</option><option value="false">false</option></select>
                        </div>
                        <div>
                            <label>Active (int)</label>
                            <input id="c-active" type="number" />
                        </div>
                        <div>
                            <label>Last Update</label>
                            <input id="c-lastUpdate" type="datetime-local" />
                        </div>
                    </div>

                    <div style="display:flex;gap:8px;margin-top:10px">
                        <button class="btn" id="btn-create">Create</button>
                        <div style="flex:1"></div>
                        <div style="width:160px">
                            <label>Update ID</label>
                            <input id="upd-id" type="number" placeholder="id to update" />
                        </div>
                        <div style="width:120px">
                            <label>&nbsp;</label>
                            <button class="btn ghost" id="btn-update">Update</button>
                        </div>
                    </div>

                    <div class="muted small" style="margin-top:10px">Note: Routes match `TestPostgresController` methods (GetCustomers, GetCustomer, CreateCustomer, UpdateCustomer, DeleteCustomer).</div>
                </section>

                <aside class="panel">
                    <h2>Output</h2>
                    <div class="list" id="outputArea">
                        <pre id="raw">Ready.</pre>
                    </div>
                    <footer>Use the controls to exercise the API — responses appear above.</footer>
                </aside>
            </div>
        </div>

        <script>
            const base = '/api/TestPostgres';
            const out = document.getElementById('raw');

            function show(obj){ out.textContent = typeof obj === 'string' ? obj : JSON.stringify(obj, null, 2); }

            function isoFromInput(v){ return v ? new Date(v).toISOString() : null; }

            document.getElementById('btn-list').addEventListener('click', async ()=>{
                const limit = Number(document.getElementById('limit').value) || 10;
                show('Loading...');
                try{
                    const res = await fetch(`${base}/GetCustomers?limit=${limit}`);
                    const data = await res.json();
                    show(data);
                }catch(e){ show(e.toString()); }
            });

            document.getElementById('btn-get').addEventListener('click', async ()=>{
                const id = Number(document.getElementById('get-id').value);
                if(!id){ show('Enter a valid id'); return; }
                show('Loading...');
                try{
                    const res = await fetch(`${base}/GetCustomer/${id}`);
                    if(res.status===404){ show('Not found'); return; }
                    const data = await res.json(); show(data);
                }catch(e){ show(e.toString()); }
            });

            document.getElementById('btn-delete').addEventListener('click', async ()=>{
                const id = Number(document.getElementById('del-id').value);
                if(!id){ show('Enter a valid id'); return; }
                show('Deleting...');
                try{
                    const res = await fetch(`${base}/DeleteCustomer/${id}`);
                    show({ status: res.status, ok: res.ok });
                }catch(e){ show(e.toString()); }
            });

            function readForm(){
                return {
                    storeId: Number(document.getElementById('c-storeId').value) || 1,
                    firstName: document.getElementById('c-firstName').value || '',
                    lastName: document.getElementById('c-lastName').value || '',
                    email: document.getElementById('c-email').value || null,
                    addressId: Number(document.getElementById('c-addressId').value) || 1,
                    activeBool: document.getElementById('c-activeBool').value === 'true',
                    active: (function(){ const v = document.getElementById('c-active').value; return v === '' ? null : Number(v); })(),
                    createDate: null,
                    lastUpdate: (function(){ const v=document.getElementById('c-lastUpdate').value; return v ? new Date(v).toISOString() : null; })()
                };
            }

            document.getElementById('btn-create').addEventListener('click', async ()=>{
                const dto = readForm();
                show('Creating...');
                try{
                    const res = await fetch(`${base}/CreateCustomer`,{
                        method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(dto)
                    });
                    const data = await res.json(); show({status:res.status, data});
                }catch(e){ show(e.toString()); }
            });

            document.getElementById('btn-update').addEventListener('click', async ()=>{
                const id = Number(document.getElementById('upd-id').value);
                if(!id){ show('Enter update id'); return; }
                const dto = readForm();
                show('Updating...');
                try{
                    const res = await fetch(`${base}/UpdateCustomer/${id}`,{
                        method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(dto)
                    });
                    show({ status: res.status, ok: res.ok });
                }catch(e){ show(e.toString()); }
            });

            // initial load
            document.getElementById('btn-list').click();
        </script>
    </body>
</html>